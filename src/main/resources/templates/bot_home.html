<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Bot home</title>
    <div th:include="fragments :: includes" />
</head>
<body th:with="privledged=${user.admin || user.roles.contains('ROLE_MOD:' + botHome.id)}">
    <div th:include="fragments :: header" />
    <div class="content">
        <h1 th:text="${botHome.name} + ' Home'" />
        <ul>
            <li th:text="'Id ' + ${botHome.id}"></li>
            <li th:if="${!privledged}" th:text="'Time Zone: ' + ${botHome.timeZone}"></li>
            <li th:if="${privledged}">Time Zone
                <select th:onchange="'updateTimeZone(event, ' + ${botHome.id} + ', \'time-zone-updated\')'"
                        th:attr="data-token=${_csrf.token}, data-header=${_csrf.headerName}">
                    <th:block th:each="timeZone : ${timeZones}">
                        <option th:value="${timeZone.value}" th:text="${timeZone.display}"
                                th:selected="${timeZone.value == botHome.timeZone}"/>
                    </th:block>
                </select> <span id="time-zone-updated" />
            </li>
        </ul>
        <h2>Services</h2>
        <table>
            <th:block th:each="serviceHomeEntry : ${botHome.serviceHomes}">
                <tr>
                    <td th:text="${serviceHomeEntry.value.service.name}"/>
                    <td th:text="${serviceHomeEntry.value.description}"/>
                </tr>
            </th:block>
        </table>
        <h2>Commands</h2>
        <table>
            <th:block th:each="command : ${botHome.commandTable.commandList}">
                <tr>
                    <td th:text="${command.key}"/>
                    <td th:text="${command.value.name}"/>
                </tr>
            </th:block>
        </table>
        <h2>Reactions</h2>
        <table>
            <th:block th:each="reaction : ${botHome.reactionTable.reactions}">
                <tr>
                    <td th:text="${reaction.emoteName}"/>
                    <td>
                        <th:block th:each="pattern : ${reaction.patterns}">
                            <span th:text="${pattern}" />
                        </th:block>
                    </td>
                </tr>
            </th:block>
        </table>
        <h2>Alerts</h2>
        <table>
            <th:block th:each="alert : ${botHome.alertGenerators}">
                <tr>
                    <td th:text="${alert.alertToken}"/>
                    <td th:text="${alert.description}"/>
                </tr>
            </th:block>
        </table>
    </div>
    <div th:include="fragments :: footer" />
</body>
</html>
