<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${botHome.name}"/>
    <div th:include="fragments :: includes" />
    <script th:if="${user.admin || user.roles.contains('ROLE_MOD:' + botHome.id)}"
            type="text/javascript" src="/script/privledged.js"></script>
</head>
<body th:with="privledged=${user.admin || user.roles.contains('ROLE_MOD:' + botHome.id)},
      streamer=${user.roles.contains('ROLE_STREAMER:' + botHome.id)},
      exalted=${user.admin || streamer}">
    <div th:include="fragments :: header" />
    <div class="content">
        <h1 th:text="'Moderation Hub for ' + ${botHome.name}"/>

        <div th:if="${privledged}">
            <div class="home-controls">
                <span class="home-status" id="status" th:text="${botHome.active ? '&#x2714;&#xFE0F' : '&#x274C;'}"
                th:title="${botHome.active ? 'Active' : 'Idle'}"/>
                <span id="play-button" class="pseudo-link home-control" th:onclick="'startHome(' + ${botHome.id} + ')'"
                        title="Restart Bot">
                    &#x25B6;
                </span>
                <span id="stop-button" class="pseudo-link home-control" th:onclick="'stopHome(' + ${botHome.id} + ')'"
                      th:style="'display: ' + ${botHome.active ? 'inline-block' : 'none'}" title="Stop Bot">
                    &#x23F9;
                </span>
            </div>
            <ul style="float: left;">
                <li th:if="${streamer}"><a href="/home">Home Ownership</a></li>
                <li><div th:include="bot_home_fragments :: bot_name"/></li>
                <li><div th:include="bot_home_fragments :: time_zone"/></li>
                <li><a href="users">Users</a></li>
            </ul>
        </div>

        <div th:if="${privledged}">
            <h2>Giveaway</h2>
            <table id="reward-table" class="data-table">
                <thead><tr>
                    <th>Prize</th>
                    <th>Status</th>
                    <th>Time Remaining</th>
                    <th>Entrants</th>
                    <th>Actions</th>
                    <th>Winner</th>
                    <th th:if="${exalted}">Delete</th>
                </tr></thead>
                <th:block th:each="reward : ${botHome.giveaway.rewards}">
                    <tr th:with="label=${'reward-' + reward.id}">
                        <td th:if="${exalted}" th:text="${reward.prize}"/>
                        <td th:if="${!exalted}">&#x1F947;</td>
                        <td th:id="${label + '-status'}" th:text="${reward.status}"/>
                        <td th:text="${reward.timeLeft}"/>
                        <td th:text="${reward.entrants.size()}"/>
                        <td>
                            <input type="button" value="Select Winner"
                                   th:onclick="'awardReward(' + ${botHome.id} + ',' + ${reward.id} + ')'"/>
                            <input type="button" value="Bestow Prize"
                            th:onclick="'bestowReward(' + ${botHome.id} + ',' + ${reward.id} + ')'"/>
                        </td>
                        <td th:id="${label + '-winner'}" th:if="${reward.winner != null}"
                            th:text="${reward.winner.discordUsername}"/>
                        <td th:id="${label + '-winner'}" th:if="${reward.winner == null}">&#x2205;</td>
                        <td th:if="${exalted}" class="pseudo-link"
                            th:onclick="'deleteReward(' + ${botHome.id} + ',' + ${reward.id} + ')'">
                            &#x1F5D1;
                        </td>
                    </tr>
                </th:block>
            </table>

            <div th:if="${privledged}" class="add-reward">
                <div id="add-reward-button" class="pseudo-link add-button" onclick="showAddRewardForm()"
                     title="Add a Reward">+</div>
                <form id="add-reward-form" class="add-form hidden"
                      th:onsubmit="'addReward(' + ${botHome.id} + '); return false;'">
                    <div>
                        <label>Prize</label><br>
                        <input type="text" id="add-reward-prize-input"><br>
                    </div><br>
                    <input type="submit" value="Submit Prize">
                </form>
            </div>
        </div>

        <div th:include="bot_home_fragments :: services"/>

        <div th:include="bot_home_fragments :: commands"/>

        <div th:include="bot_home_fragments :: reactions"/>

        <div th:include="bot_home_fragments :: alerts"/>

        <div th:include="bot_home_fragments :: storage_values"/>

        <div th:include="bot_home_fragments :: books"/>
    </div>
    <div th:include="fragments :: footer" />
</body>
</html>
